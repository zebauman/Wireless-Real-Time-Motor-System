/ {
    aliases {
        /* Aliases for our new digital Hall sensor pins */
        hall-u = &hall_u_pin;
        hall-v = &hall_v_pin;
        hall-w = &hall_w_pin;
    };

    /* Define the Hall sensors as standard GPIO inputs */
    hall_sensors {
        compatible = "gpio-keys"; 
        
        hall_u_pin: hall_u {
            /* PC2 */
            gpios = <&gpioc 2 (GPIO_ACTIVE_HIGH | GPIO_PULL_UP)>;
        };
        hall_v_pin: hall_v {
            /* PA0 */
            gpios = <&gpioa 0 (GPIO_ACTIVE_HIGH | GPIO_PULL_UP)>;
        };
        hall_w_pin: hall_w {
            /* PA1 */
            gpios = <&gpioa 1 (GPIO_ACTIVE_HIGH | GPIO_PULL_UP)>;
        };
    };
};

/* --- BARE-METAL TIMER CONFIGURATION --- */
&timers1 {
    status = "okay";
    
    pwm1: pwm {
        status = "okay"; /* Let Zephyr enable the pin multiplexing at boot */
        
        /* Pins MUST be declared in the child node */
        pinctrl-0 = <&pwm1_ch1_pa8 &pwm1_ch2_pa9 &pwm1_ch3_pa10 
                     &pwm1_ch1n_pb13 &pwm1_ch2n_pb14 &pwm1_ch3n_pb15>;
        pinctrl-names = "default";
    };
};

/* --- PIN MULTIPLEXING --- */
&pinctrl {
    /* High Side Switches */
    pwm1_ch1_pa8: pwm1_ch1_pa8 {
        pinmux = <STM32_PINMUX('A', 8, AF1)>;   /* TIM1_CH1 */
        bias-pull-down;
    };
    pwm1_ch2_pa9: pwm1_ch2_pa9 {
        pinmux = <STM32_PINMUX('A', 9, AF1)>;   /* TIM1_CH2 */
        bias-pull-down;
    };
    pwm1_ch3_pa10: pwm1_ch3_pa10 {
        pinmux = <STM32_PINMUX('A', 10, AF1)>;  /* TIM1_CH3 */
        bias-pull-down;
    };

    /* Low Side Switches (Complementary) */
    pwm1_ch1n_pb13: pwm1_ch1n_pb13 {
        pinmux = <STM32_PINMUX('B', 13, AF1)>;  /* TIM1_CH1N */
        bias-pull-down;
    };
    pwm1_ch2n_pb14: pwm1_ch2n_pb14 {
        pinmux = <STM32_PINMUX('B', 14, AF1)>;  /* TIM1_CH2N */
        bias-pull-down;
    };
    pwm1_ch3n_pb15: pwm1_ch3n_pb15 {
        pinmux = <STM32_PINMUX('B', 15, AF1)>;  /* TIM1_CH3N */
        bias-pull-down;
    };
};